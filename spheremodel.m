ms=0.463;
mp=0.930;
msl=0.549;
Isx=6158.583*10^(-6);
Isy=5109.616*10^(-6);
Isz=6157.778*10^(-6);
Ipx=3060.629*10^(-6);
Ipy=1330.453 *10^(-6);
Ipz=4085.985*10^(-6);
Islx=257.271*10^(-6);
Isly=855.018*10^(-6) ;
Islz=1007.478*10^(-6);
b1=0.05;
b2=0.05;
lp=22.652*10^(-3);
lsl=(49.500 +8.945)*10^(-3);
r=0.14;
g=9.8;
syms phi theta alpha Ysl dottheta dotphi dotalpha M11 M12 M13 M14 M22 M23 M24 M33 M34 M44 C11 C12 C13 C13 C21 C22 C23 C24 C31 C32 C33 C34 C41 C42 C43 C44 G1 G2 G3 G4 
M11(alpha,phi,Ysl)=Isy + (mp + ms + msl)*(r)^2 *(cos(phi))^2 + cos(phi)* (-2* (lp *mp + lsl *msl)* r *cos(alpha) + (Ipz + Islz) *(cos(alpha))^2 *cos(phi) + (Ipx + Islx)*cos(phi) *(sin(alpha))^2)* (sin(phi))^2 + (Ipy + Isly + (lp^2* mp + lsl^2* msl)* (cos(alpha))^2)* (sin(phi))^4 + mp *(sin(alpha))^2 *(sin(phi))^2 *(lp)^2 +  msl *sin(phi)* ((sin(alpha))^2* sin(phi) *(lsl)^2 + cos(phi) *Ysl *(-2* r *cos(phi) + 2 *lsl *cos(alpha)* (sin(phi))^2 + cos(phi)* sin(phi)* Ysl));
M12(alpha,phi,Ysl)=-(lp* mp + lsl *msl)* r* cos(alpha) *cos(phi) + (Ipy + Isly + (lp^2 *mp + lsl^2 *msl)* (cos(alpha))^2)* (sin(phi))^2 - sin(phi)* (-(sin(alpha))^2* sin(phi) *(mp*(lp)^2 + msl*(lsl)^2) - lsl *msl *cos(alpha)* cos(phi)* Ysl);
M13(alpha,phi,Ysl)=sin(alpha) *sin(phi)* ((lp *mp + lsl *msl)* r - cos(alpha) *cos(phi) *(Ipx - Ipz + Islx - Islz + lp^2* mp + msl* (lsl)^2) + lsl*msl*sin(phi)*Ysl);
M14(alpha,phi,Ysl)=-msl*cos(phi)*sin(alpha)*sin(phi)*lsl;
M22(alpha,phi,Ysl)=Ipy + Isly + lp^2* mp + lsl^2 *msl;
M23(alpha,phi,Ysl)=sin(alpha)*(mp*r*lp*sin(phi) + msl*lsl*(r *sin(phi) + Ysl));
M24(alpha,phi,Ysl)=0;
M33(alpha,phi,Ysl)=Isx + r^2*(mp + ms + msl)+ (Ipx + Islx)*(cos(alpha))^2+ (Ipz + Islz)*(sin(alpha))^2+ cos(alpha) *(cos(alpha) *(mp*lp^2 + msl*lsl^2 ) - 2*r*cos(phi) *(mp*lp + msl*lsl))+ 2*msl*r*Ysl*sin(phi) + msl*Ysl;
M34(alpha,phi,Ysl)=msl*(lsl *cos(alpha) - r *cos(phi));
M44(alpha,phi,Ysl)=msl;
C11(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=0.25*((cos(2*alpha)*(-Ipx + Ipz - Islx + Islz)+Ipx - 2*Ipy + Ipz + Islx - 2*Isly + Islz) *sin(4*phi)+4*sin(2*phi)* (Ipy + Isly + r^2*(-(mp + ms + msl)))+2*mp*r*lp* cos(alpha)*(sin(phi) - 3 *sin(3*phi))-8*mp*lp^2* sin(phi) *cos(phi) *((cos(alpha))^2* cos(2*phi) - 1)+ 2*msl* (2*lsl *cos(alpha)* sin(phi) *(3*r* cos(2*phi) + r - 2*Ysl *sin(3*phi))+ lsl^2 *(2 *sin(2*phi) - (cos(alpha))^2 * sin(4*phi))+Ysl* (Ysl* sin(4*phi) - r*(cos(phi) + 3 *cos(3*phi))))) *(dotphi);
C12(alpha,phi,Ysl,dottheta,dotalpha,dotphi)= sin(alpha)* cos(phi)* (r *(mp*lp + msl*lsl) - msl*lsl*Ysl *sin(phi))*dotalpha+2*sin(alpha)*(sin(phi))^2 *cos(phi) *(cos(alpha) *cos(phi)*(Ipx - Ipz + Islx - Islz + mp*lp^2 + msl*lsl^2 )+r*(mp*lp + msl*lsl) -msl*lsl*Ysl *sin(phi))* (dottheta)+0.5*(- cos(2*alpha)* sin(2*phi)* (Ipx - Ipz + Islx - Islz + mp*lp^2 + msl*lsl^2 )+2 *sin(2*phi)* (Ipy + Isly + mp*lp^2 + msl*lsl^2 )+ cos(alpha) *(4*r *sin(phi) *(mp*lp + msl*lsl) + 2*msl*lsl*Ysl*(cos(phi))^2))*(dotphi);
C13(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=sin(alpha)* (- cos(alpha)*cos(2*phi) *(Ipx - Ipz + Islx - Islz + mp*lp^2 + msl*lsl^2 )+r* cos(phi)* (mp*lp + msl*lsl) + msl*lsl*Ysl *sin(2*phi))*(dotphi);
C14(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=0.5*msl*lsl *sin(alpha)*(1 - 3*cos(2*phi))*(dotphi) +2*msl* sin(phi) *cos(phi)* (lsl *cos(alpha)*(sin(phi))^2 + cos(phi) *(Ysl* sin(phi) - r)) *(dottheta);
C21(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=(sin(alpha) *(sin(phi))^2 *cos(phi)* (msl*lsl*(Ysl *sin(phi) - r) - mp*r*lp)-(1/8)*sin(2*alpha)*(sin(2*phi))^2*(Ipx - Ipz + Islx - Islz + mp*lp^2 + msl*lsl^2 ))*(dottheta);
C22(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=0;
C23(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=sin(alpha)* cos(alpha)* (Ipx - Ipz + Islx - Islz + mp*lp^2 + msl*lsl^2 )*(dotphi)+0.5*(sin(2*phi)*(cos(2*alpha)*(Ipx - Ipz + Islx - Islz) + 2*(Ipy + Isly))+ (cos(2*alpha) + 2) *sin(2*phi)* (mp*lp^2 + msl*lsl^2 )+msl*lsl*Ysl*cos(alpha)*(3*cos(2*phi) - 1))*(dottheta);
C24(alpha,phi,Ysl,dottheta,dotalpha,dotphi)= msl*lsl *cos(alpha)* sin(2*phi)*(dottheta)+ 2*msl*lsl*sin(alpha)*(dotphi);
C31(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=(1/4)*(-0.5* sin(4*phi)* (Ipx - 2*Ipy + Ipz + Islx - 2*Isly+ Islz + 2*msl*Ysl^2)+0.5*cos(2*alpha)* sin(4*phi)*(Ipx - Ipz + Islx - Islz)+ 2* sin(2*phi)* (-Ipy - Isly + r^2*(mp + ms + msl))+ mp*r*lp *cos(alpha)*(3* sin(3*phi) - sin(phi))+ mp*lp^2 *((cos(alpha))^2 *sin(4*phi) - 2 *sin(2*phi))+ 2*msl*lsl* cos(alpha)* sin(phi)* (3*r *cos(2*phi) + r - 2*Ysl *sin(3*phi))+ msl*lsl ^2* ((cos(alpha))^2 *sin(4*phi) - 2* sin(2*phi))+msl*r*Ysl *cos(phi) + 3*msl*r*Ysl* cos(3*phi))*(dottheta);
C32(alpha,phi,Ysl,dottheta,dotalpha,dotphi)= cos(alpha)*(mp*r*lp *sin(phi) + msl*lsl*(r* sin(phi) + Ysl))*(dotalpha)+0.5*(- sin(2*phi)*((cos(2*alpha)*(Ipx - Ipz + Islx - Islz) + 2*(Ipy + Isly)))- (cos(2*alpha) + 2)* sin(2*phi) *(mp*lp^2 + msl*lsl^2 )+msl*lsl*Ysl*cos(alpha)*(1 - 3*cos(2*phi)))*(dottheta);
C33(alpha,phi,Ysl,dottheta,dotalpha,dotphi)= (r *cos(alpha)* sin(phi) *(mp*lp + msl*lsl) + msl*r*Ysl *cos(phi))*(dotphi)+ (r* sin(alpha)* cos(phi) *(mp*lp + msl*lsl)- sin(2*alpha)* (Ipx- Ipz + Islx - Islz + mp*lp^2 + msl*lsl^2 ))* (dotalpha);
C34(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=(msl*lsl *sin(alpha)*(cos(phi))^2)*(dottheta)+2*msl *(r* sin(phi) + Ysl)*(dotphi) ;
C41(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=- msl* sin(phi)* cos(phi)* (lsl *cos(alpha) *(sin(phi))^2 + cos(phi) *(Ysl *sin(phi) - r))*(dottheta);
C42(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=- msl*lsl* cos(alpha)* sin( 2*phi)*(dottheta)-2*msl*lsl *sin(alpha)*(dotphi);
C43(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=-msl*Ysl*dotphi- (msl*lsl *sin(alpha) *(cos(phi))^2)*dottheta;
C44(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=0;
G1(alpha,phi,Ysl)=0;
G2(alpha,phi,Ysl)= (mp*lp + msl*lsl)*g*sin(alpha)*cos(phi);
G3(alpha,phi,Ysl)=g *(cos (alpha)* sin(phi)* (mp*lp + msl*lsl) + msl*Ysl *cos(phi));
G4(alpha,phi,Ysl)=msl*g *sin (phi);
M(alpha,phi,Ysl)=[M11,M12,M13,M14;M12,M22,M23,M24;M13,M23,M33,M34;M14,M24,M34,M44];
C(alpha,phi,Ysl,dottheta,dotalpha,dotphi)=[C11,C12,C13,C14;C21,C22,C23,C24;C31,C32,C33,C34;C41,C42,C43,C44];